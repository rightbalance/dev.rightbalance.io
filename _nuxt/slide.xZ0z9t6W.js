import{_ as N}from"./client-only.LUgq4Lc6.js";import{_ as Z}from"./nuxt-img.xyyZrQjx.js";import{v as n,x as T,f as W,y as ee,E as A,o as c,c as d,A as w,B as C,a as v,b as g,w as D,C as k,F as I,q as F,ao as O,h as p,j as q,n as z,_ as M,G as oe,i as ae}from"./entry.gI76ijC1.js";import{u as S}from"./assets.HpGB0TDX.js";const j=()=>{const m=n();return T(()=>{const l=document.createElement("video");m.value=!!l.canPlayType("video/webm")}),{isIos:["iPhone","iPad"].includes((navigator||{}).platform),canPlayWebm:m}},te={class:"unset"},le=["autoplay","loop"],se={class:"table fallback-image"},ne={class:"cell"},ie=W({__name:"video",props:{name:{default:""},loopPart:{default:""},mobileFallback:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},playOnScroll:{type:Boolean,default:!1}},setup(m){const t=m,l=n(null),a=n(null),y=n(!1),f=n(!1),r=n(!1),b=n([]),h=n([]),$={muted:!0,playsinline:!0,preload:"auto","webkit-playsinline":!0},G=["diamond","head","box","plexus"],_=t.name.replace("-intro",""),R={callback:H,once:!0,intersection:{threshold:.5}},{canPlayWebm:B,isIos:U}=j(),E=G.includes(_);async function H(e){var i,u;const{playOnScroll:o,loopPart:s}=t;r&&(o&&e||!o)&&(await((i=l.value)==null?void 0:i.play()),s&&await((u=a.value)==null?void 0:u.play()))}function V(e){const o=[];return B?o.push({src:S(`videos/${e}.webm`),type:"video/webm"}):E&&window.screen.availWidth<=768?o.push({src:S(`videos/mobile/fallback/${e}.mp4`),type:"video/mp4",media:"(max-width: 768px)"}):o.push({src:S(`videos/fallback/${e}.mp4`),type:"video/mp4",media:"(min-width: 768px)"}),o}function J(){a.value&&a.value.pause&&(a.value.pause(),a.value.currentTime=0)}async function K(){if(l.value){try{await l.value.play(),r.value=!0}catch(e){console.log("err",e),r.value=e.name!=="NotAllowedError"}t.playOnScroll&&l.value.pause()}}function Q(e){const{y:o}=e.getBoundingClientRect();return o>=-100&&o<=100}async function L(){document.visibilityState==="visible"&&[l,a].forEach(o=>{var s;o.value&&Q(o.value)&&((s=o.value)==null||s.play())})}T(async()=>{var o,s,i,u;const{loopPart:e}=t;b.value=V(t.name),e&&(h.value=V(t.loopPart)),K(),U&&t.playOnScroll&&r&&(await((o=l.value)==null?void 0:o.play()),(s=l.value)==null||s.pause(),e&&(await((i=a.value)==null?void 0:i.play()),await((u=a.value)==null?void 0:u.pause()))),document.addEventListener("visibilitychange",L,!1)}),ee(()=>{document.removeEventListener("visibilitychange",L)});async function X(){var e;t.loopPart&&a.value&&(a.value.currentTime=0,await((e=a.value)==null?void 0:e.play()),y.value=!0)}function Y(){f.value=!0}return(e,o)=>{const s=N,i=Z,u=A("observe-visibility");return c(),d("div",{class:z({wrap:!0,"fill-space":!p(B),"has-mobile-playback":p(E)})},[w(v("div",te,[g(s,null,{default:D(()=>[w(v("div",null,null,512),[[u,R]])]),_:1}),v("video",k({ref_key:"player",ref:l},$,{autoplay:!t.playOnScroll,loop:t.loop&&!t.loopPart,style:{opacity:y.value?"0":"1"},onEnded:X,onCanplay:Y}),[(c(!0),d(I,null,F(b.value,(P,x)=>(c(),d("source",O(k({key:x},P)),null,16))),128)),g(i,{src:`/video-posters/${p(_)}.png`,alt:`${p(_)} background image`},null,8,["src","alt"])],16,le),e.loopPart?(c(),d("video",k({key:0,ref_key:"playerLoop",ref:a},$,{loop:!0,style:{transform:y.value?"":"scale(0)"},onLoadedmetadata:J}),[(c(!0),d(I,null,F(h.value,(P,x)=>(c(),d("source",O(k({key:x},P)),null,16))),128))],16)):q("",!0)],512),[[C,r.value]]),w(v("div",se,[v("div",ne,[g(i,{src:`/video-posters/${p(_)}.png`,alt:`${p(_)} background image`},null,8,["src","alt"])])],512),[[C,!r.value]])],2)}}}),ce=M(ie,[["__scopeId","data-v-eb996892"]]),re={class:"content"},ue={class:"observer"},de=W({__name:"slide",props:{backgroundVideo:Boolean},setup(m){const t=j();function l(f){a.value=f}let a=n(!1);const y={callback:l,once:!t,intersection:{threshold:.3}};return(f,r)=>{const b=N,h=A("observe-visibility");return c(),d("section",{class:z({slide:!0,visible:p(a)})},[v("div",re,[oe(f.$slots,"default",{},void 0,!0),g(b,null,{default:D(()=>[w(v("div",ue,null,512),[[h,y]])]),_:1})]),m.backgroundVideo?(c(),ae(ce,{key:0,name:"plexus",class:"bg-video",loop:!0,"mobile-fallback":!0})):q("",!0)],2)}}}),fe=M(de,[["__scopeId","data-v-68c9b256"]]);export{ce as V,fe as _,j as u};
