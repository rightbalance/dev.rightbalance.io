import{_ as P}from"./client-only.gOfQvzGT.js";import{_ as W}from"./nuxt-img.viYSb3MM.js";import{v as m,x as $,f as B,y as j,E as x,o as y,c as h,a as l,b,w as E,A as C,C as g,h as s,j as S,n as V,_ as I,G as z,i as G}from"./entry.Wsprb3zx.js";import{u as d}from"./assets.QKbncBki.js";const R=()=>{const p=m();return $(()=>{const n=document.createElement("video");p.value=!!n.canPlayType("video/webm")}),{isIos:["iPhone","iPad"].includes((navigator||{}).platform),canPlayWebm:p}},U={class:"unset"},q=["autoplay","loop","poster"],H=["src"],J=["src"],K=["src"],Q=["src"],X=["src"],Y=["src"],Z=B({__name:"video",props:{name:{default:""},loopPart:{default:""},mobileFallback:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},playOnScroll:{type:Boolean,default:!1}},setup(p){const t=p,n=m(null),o=m(null),r=m(!1),w=m(!1),v={muted:!0,playsinline:!0,preload:"auto","webkit-playsinline":!0},f=["diamond","head","box","plexus"],_=t.name.replace("-intro",""),L={callback:D,once:!0,intersection:{threshold:.5}},{canPlayWebm:N,isIos:te}=R(),T=f.includes(_);async function D(e){var c,u;console.log("isVisible",e,t.name);const{playOnScroll:a,loopPart:i}=t;(a&&e||!a)&&(await((c=n.value)==null?void 0:c.play()),i&&await((u=o.value)==null?void 0:u.play()))}function F(){o.value&&o.value.pause&&(o.value.pause(),o.value.currentTime=0)}function O(e){const{y:a}=e.getBoundingClientRect();return a>=-100&&a<=100}async function k(){document.visibilityState==="visible"&&[n,o].forEach(a=>{var i;a.value&&O(a.value)&&((i=a.value)==null||i.play())})}$(async()=>{var a,i,c,u;const{loopPart:e}=t;await((a=n.value)==null?void 0:a.play()),(i=n.value)==null||i.pause(),e&&(await((c=o.value)==null?void 0:c.play()),await((u=o.value)==null?void 0:u.pause())),document.addEventListener("visibilitychange",k,!1)}),j(()=>{document.removeEventListener("visibilitychange",k)});async function A(){var e;t.loopPart&&o.value&&(o.value.currentTime=0,await((e=o.value)==null?void 0:e.play()),r.value=!0)}function M(){w.value=!0}return(e,a)=>{const i=P,c=W,u=x("observe-visibility");return y(),h("div",{class:V({wrap:!0,"fill-space":!s(N),"has-mobile-playback":s(T)})},[l("div",U,[b(i,null,{default:E(()=>[C(l("div",null,null,512),[[u,L]])]),_:1}),l("video",g({ref_key:"player",ref:n},v,{autoplay:!t.playOnScroll,loop:t.loop&&!t.loopPart,style:{opacity:r.value?"0":"1"},onEnded:A,onCanplay:M,poster:s(d)(`/video-posters/${e.name}.png`)}),[l("source",{src:s(d)(`videos/${e.name}.webm`),type:"video/webm"},null,8,H),l("source",{src:s(d)(`videos/mobile/fallback/${e.name}.webm`),type:"video/mp4",media:"(max-width: 768px)"},null,8,J),l("source",{src:s(d)(`videos/fallback/${e.name}.webm`),type:"video/mp4",media:"(min-width: 768px)"},null,8,K),b(c,{src:`/video-posters/${s(_)}.png`,alt:`${s(_)} background image`},null,8,["src","alt"])],16,q),e.loopPart?(y(),h("video",g({key:0,ref_key:"playerLoop",ref:o},v,{loop:!0,style:{transform:r.value?"":"scale(0)"},onLoadedmetadata:F}),[l("source",{src:s(d)(`videos/${e.loopPart}.webm`),type:"video/webm"},null,8,Q),l("source",{src:s(d)(`videos/mobile/fallback/${e.loopPart}.webm`),type:"video/mp4",media:"(max-width: 768px)"},null,8,X),l("source",{src:s(d)(`videos/fallback/${e.loopPart}.webm`),type:"video/mp4",media:"(min-width: 768px)"},null,8,Y),b(c,{src:`/video-posters/${s(_)}.png`,alt:`${e.loopPart} background image`},null,8,["src","alt"])],16)):S("",!0)])],2)}}}),ee=I(Z,[["__scopeId","data-v-b065b3cc"]]),oe={class:"content"},ae={class:"observer"},se=B({__name:"slide",props:{backgroundVideo:Boolean},setup(p){function t(r){n.value=r}let n=m(!1);const o={callback:t,intersection:{threshold:.3}};return(r,w)=>{const v=P,f=x("observe-visibility");return y(),h("section",{class:V({slide:!0,visible:s(n)})},[l("div",oe,[z(r.$slots,"default",{},void 0,!0),b(v,null,{default:E(()=>[C(l("div",ae,null,512),[[f,o]])]),_:1})]),p.backgroundVideo?(y(),G(ee,{key:0,name:"plexus",class:"bg-video",loop:!0,"mobile-fallback":!0})):S("",!0)],2)}}}),re=I(se,[["__scopeId","data-v-32a65f92"]]);export{re as _,ee as a,R as u};
